#include <iostream>
#include <limits>
#include <cstring>

using namespace std;

// sis ir vajadzigs waitForKey() funkcijas darbam
const int MAX_STR_LEN = 100;
char line[MAX_STR_LEN];

// korektam ievadam
int getIntInput() {
    int num;
    while (true) {
        if (cin >> num) return num;
        cout << "Nepareiza ievade! Ludzu ievadiet veselu skaitli: ";
        cin.clear();
        cin.ignore(numeric_limits<streamsize>::max(), '\n');
    }
}

class Node
{
public:
    int value;
    Node* next;

    Node(int value) {
        this->value = value;
        next = NULL;
    }
};

class MyDequeue
{
public:
    Node* first;

    MyDequeue() {
        first = NULL;
    }

    ~MyDequeue() {
        Node* cursor = first;
        while (cursor != NULL) {
            Node* temp = cursor;
            cursor = cursor->next;
            delete temp;
        }

        cout << "\nDEKS DZESTS -----------------------\n";
    }

    void printDequeue() {
        if (first == NULL)
        {
            cout << "\nDeks ir tukss!\n";
            return;
        }

        Node* cursor = first;

        cout << "\n-------------Deks-----------------\n";
        cout << cursor->value << " ";
        while (cursor->next != NULL)
        {
            cout << cursor->next->value << " ";
            cursor = cursor->next;
        }
        cout << "\n-------------Deks-----------------\n";
    }

    void addRight(int val)
    {
        Node* newNode = new Node(val);

        if (first == NULL) first = newNode;
        else {
            Node* cursor = first;

            while (cursor->next != NULL) cursor = cursor->next;
            cursor->next = newNode;
        }

        cout << "\n" << val << " elements veiksmigi pievienots (beigas)\n";
        printDequeue();
    }

    void addLeft(int val)
    {
        Node* newNode = new Node(val);

        if (first == NULL) first = newNode;
        else
        {
            Node* second = first;
            first = newNode;
            first->next = second;
        }

        cout << "\n" << val << " elements veiksmigi pievienots (sakumaa)\n";
        printDequeue();
    }

    int popRight()
    {
        int val;
        if (first == NULL) {
            cout << "Deks ir tukss\n";
            return NULL;
        }
        else
        {
            if (first->next == NULL)
            {
                val = first->value;
                delete first;
                first = NULL;
                return val;
            }
            else
            {
                Node* prev = first;
                Node* cursor = first->next;

                while (cursor->next != NULL)
                {
                    prev = cursor;
                    cursor = cursor->next;
                }

                val = cursor->value;
                prev->next = NULL;
                delete cursor;
                printDequeue();
                return val;
            }
        }
    }

    int popLeft()
    {
        int val;
        if (first == NULL) {
            cout << "Deks ir tukss\n";
            return NULL;
        }
        else
        {
            val = first->value;
            Node* next = first->next;
            delete first;
            first = next;
            cout << "Pirmais elements dzests\n";
            printDequeue();
            return val;
        }
    }

    int getCount()
    {
        int i = 0;
        Node* cursor = first;

        while (cursor != NULL) {
            i++;
            cursor = cursor->next;
        }

        return i;
    }
};

void waitForKey() {
    cout << "\nNospied ENTER, lai turpinatu... ";
    cin.ignore(numeric_limits<streamsize>::max(), '\n');
    cin.getline(line, MAX_STR_LEN);
}

int main()
{
    MyDequeue stack1;
    int choice, val, elem;

    cout << "\nAutors: Anastasija Kizika, IT 2. kurss";
    cout << "\nProgrammas nosaukums: Datu struktura - Deks\n\n";
    waitForKey();

    while (true)
    {
        system("cls");
        cout << "\n-------------MENU-----------------\n";
        cout << "1. Izvadit steku\n";
        cout << "2. Noteikt steka garumu\n";
        cout << "3. Pievienot elementu deka sakuma\n";
        cout << "4. Pievienot elementu deka beigaas\n";
        cout << "5. Iznemt elementu no deka sakuma\n";
        cout << "6. Iznemt elementu no deka beigaam\n";
        cout << "7. Dzest visu deku\n";
        cout << "0. Iziet\n";
        cout << "Ievadiet jusu izveli: ";
        choice = getIntInput();

        switch (choice)
        {
        case 1:
            stack1.printDequeue();
            cout << "Deka garums: " << stack1.getCount() << "\n";
            waitForKey();
            break;
        case 2:
            cout << "\nDeka garums: " << stack1.getCount() << "\n";
            waitForKey();
            break;
        case 3:
            cout << "Ievadiet jaunu elementu: ";
            val = getIntInput();
            stack1.addLeft(val);
            waitForKey();
            break;
        case 4:
            cout << "Ievadiet jaunu elementu: ";
            val = getIntInput();
            stack1.addRight(val);
            waitForKey();
            break;
        case 5:
            val = stack1.popLeft();
            if (val != NULL) cout << "\nNo deka tika iznemts elements " << val << "\n";
            waitForKey();
            break;
        case 6:
            val = stack1.popRight();
            if (val != NULL) cout << "\nNo deka tika iznemts elements " << val << "\n";
            waitForKey();
            break;;
        case 7:
            stack1 = MyDequeue();
            stack1.printDequeue();
            waitForKey();
            break;
        case 0:
            cout << "Iziet...\n";
            return 0;
        default:
            cout << "Nepareiza izvele\n";
        }
    }
}
